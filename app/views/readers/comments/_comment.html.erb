<div class="card mt-3 rounded">
  <div class="card-header d-flex justify-content-between">
    <% if comment.author == current_author %>
      <small>You</small>
    <%else%>
      <small>
        <strong><%= @post.author.first_name %> <%= @post.author.last_name %></strong>
      </small>
    <% end %>
    <span>
      <small><%= time_ago_in_words(comment.created_at)%> ago</small>
    </span>
  </div>
  <div class="card-body rounded-bottom">
    <div class="mb-3">
      <%= comment.content%>
    </div>
    <div class="mb-1 d-flex justify-content-between text-center">
      <span class="d-flex">
        <% like = current_author.likes.find_by(comment: comment) %>
        <% if like.nil? %>
          <%= button_to "♡", likes_path, params: {like: {comment_id: comment.id }}, method: :post, class:"btn btn-primary btn-sm mr-2" %>
        <%else %>
          <%= button_to "🤍", like_path(like), method: :delete, class:"btn btn-secondary btn-sm mr-2" %>
        <% end %>
        <% if comment.parent_id.nil? %>
          <small class="comment-form-display mr-2 height-0 btn btn-primary btn-sm">
            <a href="#" class="text-decoration-none text-white">Reply</a>
          </small>
          <div class="comment-form">
            <%= render partial: 'readers/comments/form', locals: {post: comment.post, parent: comment} %>
          </div>
        <% end %>
          </span>
        <span>
          <% if current_author.id != comment.author_id %>
            <% report = current_author.reports.find_by(comment: comment) %>
            <% if report.nil? %>
            <i class="fa-solid fa-diamond-exclamation"></i>
              <%= button_to "Report", reports_path, params: {report: {comment_id: comment.id }}, method: :post, class:"btn btn-dark btn-sm"%>
            <%else%>
              <%= button_to "Cancel Report", report_path(report), method: :delete, class:"btn btn-secondary btn-sm"%>
            <% end %>
          <%else%>
            <small class="mb-3">
              <%= comment.reports.count%> reports
            </small>
          <%end%>
          <span>
        </div>
        <div class="mb-6 ">
          <span class="d-flex ">
            <small class="mr-2 text-center" >
              <%= comment.likes.count %> likes
            </small>
            <% if comment.parent_id.nil? %>
              <small>
                <%= comment.comments.count %> replies
              </small>
            <% end %>
          </span>
          <span></span>
        </div>
        <div class="pl-4">
          <%= render comment.comments.includes(:author).order(id: :desc) %>
        </div>
      </div>
    </div>
